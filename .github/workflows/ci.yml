name: DrRepo CI/CD Pipeline
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - uses: actions/setup-python@v5
      with: { python-version: '3.11' }
    - run: pip install -r requirements.txt pytest pytest-cov
    - run: pytest --cov=src --cov-report=xml tests/
    - uses: codecov/codecov-action@v4
  docker:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - run: docker-compose build --no-cache
    - run: docker-compose up -d
    - run: sleep 30 && docker-compose ps
